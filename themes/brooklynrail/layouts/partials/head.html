<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  {{/* NOTE: the Site's title, and if there is a page title, that is set too */}}
  <title>{{- block "title" . -}}{{ with .Params.Title -}}{{- . | markdownify }} | {{ end }}{{ .Site.Title -}}{{- end -}}</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <link rel="canonical" href="{{- .Permalink -}}" />
  {{- .Hugo.Generator -}}


  {{/*
  ===================================================
  Opengraph Meta Tags

  If is a PAGE and is in the Events section... */}}
  {{- $meta_title := .Title -}}

  {{- $meta_description := "" -}}
  {{- if and (eq .Kind "page") (eq .Section "events") -}}
    {{- $series := "" -}}
    {{- if .Params.series -}}
      {{- $series = print "#" .Params.series " | " }}
    {{ end -}}
    {{- $meta_description = print $series .Summary -}}
  {{- else -}}
    {{- $meta_description = .Summary -}}
  {{- end -}}

  {{/* Featured image */}}
  {{- $card_filename := print "/img/brooklynrail-card-" (index (seq 6 | shuffle) 0) ".png" -}}

  {{ "<!-- Schema.org -->" | safeHTML }}
  {{/* NOTE: These Hugo Internal Templates can be found starting at https://github.com/spf13/hugo/blob/master/tpl/tplimpl/template_embedded.go#L158 */}}
  {{/* {{- template "_internal/google_news.html" . -}} */}}
  {{- partial "meta/schema.html" . -}}

  {{ "<!-- Start of Open Graph tags -->" | safeHTML }}
  <meta property="og:title" content="{{- $meta_title -}}" />
  <meta property="og:description" content="{{- $meta_description | default $.Site.Params.description | markdownify -}}" />
  <meta property="og:type" content="{{- if .IsPage -}}article{{- else -}}website{{- end -}}" />
  <meta property="og:url" content="{{- .Permalink -}}" />
  {{ if $.Params.youtube_id -}}<meta property='og:video' content='https://www.youtube.com/v/{{ $.Params.youtube_id }}' />{{- end }}
  {{- with $card_filename }}
  <meta property="og:image" content="{{ . | relURL }}" />
  {{ end -}}
  {{ "<!-- End of Open Graph tags -->" | safeHTML }}

  {{ "<!-- Start of Twitter Card -->" | safeHTML }}
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@TheBrooklynRail" />
  <meta name="twitter:creator" content="@TheBrooklynRail" />
  {{- with $card_filename }}
  <meta property="twitter:image:src" content="{{ . | relURL }}" />
  {{ end -}}
  <meta property="twitter:title" content="{{- $meta_title | default $.Site.Title | markdownify -}}">
  <meta property="twitter:description" content="{{- $meta_description | default $.Site.Params.description | markdownify -}}">
  {{ "<!-- End of Twitter -->" | safeHTML }}

  {{ "<!-- Favicons & Icons -->" | safeHTML }}
  <link rel="apple-touch-icon" href="./images/dist/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="57x57" href="./images/dist/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="./images/dist/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="./images/dist/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="./images/dist/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="./images/dist/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="./images/dist/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="./images/dist/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="./images/dist/apple-touch-icon-180x180.png" />

  {{ "<!-- RSS Feeds -->" | safeHTML }}
  {{- with .OutputFormats.Get "RSS" -}}
    <link href="{{- .RelPermalink -}}" rel="alternate" type="application/rss+xml" title="{{- $.Site.Title -}}" />
    <link href="{{- .RelPermalink -}}" rel="feed" type="application/rss+xml" title="{{- $.Site.Title -}}" />
  {{- end }}

  {{ "<!-- Sitemap-->" | safeHTML }}
  <link rel="sitemap" type="application/xml" title="Digital.gov Sitemap" href="{{- "sitemap.xml" | absURL -}}" />

  {{/* NOTE: For Production make sure you add `HUGO_ENV="production"` before your build command */}}
  {{- if eq (getenv "HUGO_ENV") "production" | or (eq .Site.Params.env "production") }}
  <meta NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
  {{- else }}
  <meta NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
  {{- end }}

  {{/* Base CSS styles */}}
  {{ "<!-- CSS -->" | safeHTML }}
  <link rel="stylesheet" href='{{- "material/dist/styles.css" | relURL -}}' type="text/css" media='all' />
  {{/* Custom CSS — needs to be included before the base styles */}}
  {{- if $.Params.css -}}
    {{- range $.Params.css -}}
      {{- $path := (printf "material/dist/%s" .) | relURL -}}
      <!-- CUSTOM CSS -->
      <link rel="stylesheet" media="all" href="{{- $path -}}" type="text/css"/>
    {{- end -}}
  {{- end -}}

  {{/* Add to Calendar */}}
  {{- if and (eq .Section "events") -}}
  {{ "<!-- Add to Calendar CSS -->" | safeHTML }}
  <link href="{{- "material/dist/add-to-cal.css" | relURL -}}" rel="stylesheet" type="text/css">
  {{ "<!-- Add to Calendar JS -->" | safeHTML }}
  <script type="text/javascript" src="https://addevent.com/libs/atc/1.6.1/atc.min.js" async defer></script>
  {{- end }}

  {{ "<!-- Font Awesome -->" | safeHTML }}
  <link href="{{- "material/dist/fontawesome/css/all.min.css" | relURL -}}" rel="stylesheet" type="text/css">


  {{ if eq (getenv "HUGO_ENV") "production" | or (eq .Site.Params.env "production")  }}
    {{- partial "meta/google_analytics.html" . -}}
  {{ end }}

</head>
